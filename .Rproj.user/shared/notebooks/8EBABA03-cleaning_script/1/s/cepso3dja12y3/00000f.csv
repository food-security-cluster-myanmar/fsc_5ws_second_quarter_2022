"0",""
"0",""
"0","clean_fsc <- function(tbl) {"
"0","  "
"0","  tbl %>% "
"0","    rename_all(~str_replace_all(., ""^number_of_"", """")) %>%"
"0","    rename_all(~str_replace_all(., ""^number_"", """")) %>% "
"0","    rename_all(~str_replace_all(., ""reached_"", """")) %>% "
"0","    rename(specify_location = specify_location_if_the_the_location_is_not_in_the_list) %>% "
"0","    mutate(idp_camp_site_name= as.character(idp_camp_site_name)) %>% "
"0","    mutate(location = case_when(!is.na(idp_camp_site_name) ~ idp_camp_site_name,"
"0","                                !is.na(village_ward) ~ village_ward,"
"0","                                !is.na(specify_location) ~ specify_location,"
"0","                                !is.na(village_tract_town) ~ village_tract_town)) %>%"
"0","    mutate(date = my(month_of_implementation), "
"0","           quarter = ifelse(date >= ""2022-04-01"", ""q2"", ""q1"")) %>% "
"0","    rename(activity = fsc_main_activity) %>% "
"0","    mutate(township = recode(township, ""Putao"" = ""Puta-O""), "
"0","           admin3_pcode = ifelse(township == ""Puta-O"", "
"0","                                 ""MMR001014"", "
"0","                                 admin3_pcode)) %>% "
"0","    left_join(pcode4 %>% select(township, vt_town, "
"0","                                admin3_pcode, admin4_pcode, admin1_pcode), by = "
"0","                c(""village_tract_town"" = ""vt_town"", "
"0","                  ""township"" = ""township"", "
"0","                  ""admin3_pcode"" = ""admin3_pcode"", "
"0","                  ""admin1_pcode"" = ""admin1_pcode"")) %>% "
"0","    mutate(total_value_usd = case_when(currency == ""MMK"" ~ total_value / 1776, "
"0","                                       currency == ""USD"" ~ total_value)) %>% "
"0","    rename(state = state_region, "
"0","           admin3_pcode_old = ocha_pcode) %>%"
"0","    # Not necessary as Aung has already prepared it"
"0","    # mutate(admin3_pcode_old = case_when(admin3_pcode %in% "
"0","    # c(""MMR013046"", ""MMR013047"") ~ ""MMR013008"","
"0","    # admin3_pcode == ""MMR015202"" ~ ""MMR015022"","
"0","    #                                 admin3_pcode == ""MMR015315"" ~ ""MMR015010"", "
"0","    #                                 admin3_pcode == ""MMR015312"" ~ ""MMR015006"",	"
"0","    #                                 admin3_pcode == ""MMR015308"" ~ ""MMR015007"","
"0","    #                                 admin3_pcode == ""MMR016321"" ~ ""MMR016003"", "
"0","    #                                 TRUE ~ admin3_pcode)) %>% "
"0","    # removing a duplicate entry from the left join "
"0","    mutate(drop = case_when(admin4_pcode == ""MMR007008058"" ~ 1, TRUE ~ 0)) %>%"
"0","    filter(drop != 1) %>% select(-drop) %>%"
"0","    rename(response_plan = response_plan_if_project_under_fts) %>% "
"0","    replace_na(list(new_beneficiaries = 0)) %>% "
"0","    mutate(activity_red = "
"0","             case_when(activity %in% "
"0","                         c(""food distributions (in kind/voucher/cash), moderate"","
"0","                           ""food distributions (in kind/voucher/cash), severe"") ~"
"0","                         ""food distribution"","
"0","                       activity %in% "
"0","                         c(""multi-purpose cash transfer (MPC), moderate"","
"0","                           ""multi-purpose cash transfer (MPC), severe"") ~"
"0","                         ""multi-purpose cash transfer"","
"0","                       activity == ""livelihoods vocational training"" ~ "
"0","                         ""vocational training"","
"0","                       activity == ""food/cash for work/assets"" ~ "
"0","                         ""food_cash for work_assets"","
"0","                       activity == ""income-generating activities and small grants"" ~ "
"0","                         ""IGA and small grants"", "
"0","                       activity == ""HEB and fortified rice for acute emergencies"" ~ "
"0","                         ""HEB and fortfied rice"", "
"0","                                    TRUE ~ activity), "
"0","           activity_red = str_remove_all(activity_red, ""provision of "")) %>%"
"0","    mutate(strat_obj = case_when(activity_red %in% "
"0","                                   c(""food distribution"", "
"0","                                     ""multi-purpose cash transfer"") &"
"0","                                   beneficiary_type == ""Internally Displaced"" ~ "
"0","                            ""so_1"", "
"0","                          activity_red %in% c(""food distribution"", "
"0","                                              ""multi-purpose cash transfer"") & "
"0","                            beneficiary_type != ""Internally Displaced"" ~ "
"0","                            ""so_2"", "
"0","                          TRUE ~ ""so_3"")) %>% "
"0","     # these partners did not provide the numbers of households"
"0","    mutate(households = ifelse(is.na(households), beneficiaries, households)) %>% "
"0","    mutate(usd_per_hhd = total_value_usd / households, "
"0","           usd_per_person = total_value_usd / beneficiaries) %>% "
"0","    mutate(usd_hhd_bin = case_when(usd_per_hhd < 10 ~ ""<$10"","
"0","                       usd_per_hhd >= 10 & usd_per_hhd < 20 ~ "">=$10_<$20"","
"0","                       usd_per_hhd >= 20 & usd_per_hhd < 30 ~ "">=$20_<$30"","
"0","                       usd_per_hhd >= 30 & usd_per_hhd < 40 ~ "">=$30_<$40"","
"0","                       usd_per_hhd >= 40 & usd_per_hhd < 50 ~ "">=$40_<$50"","
"0","                       usd_per_hhd >= 50 & usd_per_hhd < 60 ~ "">=$50_<$60"","
"0","                       usd_per_hhd >= 60 & usd_per_hhd < 70 ~ "">=$60_<$70"","
"0","                       usd_per_hhd >= 70 & usd_per_hhd < 80 ~ "">=$70_<$80"","
"0","                       usd_per_hhd >= 80 & usd_per_hhd < 90 ~ "">=$80_<$90"","
"0","                       usd_per_hhd >= 90 & usd_per_hhd < 100 ~ "">=$90_<$100"","
"0","                       usd_per_hhd >= 100 ~ "">=$100"","
"0","                       TRUE ~ NA_character_),"
"0","           usd_hhd_bin = fct_relevel(usd_hhd_bin, c(""<$10"", "">=$10_<$20"", "
"0","                                                    "">=$20_<$30"", "">=$30_<$40"", "
"0","                                                    "">=$40_<$50"","">=$50_<$60"", "
"0","                                                    "">=$60_<$70"", "">=$70_<$80"", "
"0","                                                    "">=$80_<$90"","">=$90_<$100"", "
"0","                                                    "">=$100""))) %>% "
"0","    mutate(usd_person_bin = case_when(usd_per_person < 2 ~ ""<$2"","
"0","                                   usd_per_person >= 2 & "
"0","                                     usd_per_person < 4 ~ "
"0","                                     "">=$2_<$4"","
"0","                                   usd_per_person >= 4 & "
"0","                                     usd_per_person < 6 ~ "
"0","                                     "">=$4_<$6"","
"0","                                   usd_per_person >= 6 & "
"0","                                     usd_per_person < 8 ~ "
"0","                                     "">=$6_<$8"","
"0","                                   usd_per_person >= 8 & "
"0","                                     usd_per_person < 10 ~ "
"0","                                     "">=$8_<$10"","
"0","                                   usd_per_person >= 10 & "
"0","                                     usd_per_person < 12 ~ "
"0","                                     "">=$10_<$12"","
"0","                                   usd_per_person >= 12 & "
"0","                                     usd_per_person < 14 ~ "
"0","                                     "">=$12_<$14"","
"0","                                   usd_per_person >= 14 & "
"0","                                     usd_per_person < 16 ~ "
"0","                                     "">=$14_<$16"","
"0","                                   usd_per_person >= 16 & "
"0","                                     usd_per_person < 18 ~ "
"0","                                     "">=$16_<$18"","
"0","                                   usd_per_person >= 18 & "
"0","                                     usd_per_person < 20 ~ "
"0","                                     "">=$18_<$20"","
"0","                                   usd_per_person >= 20 ~ "
"0","                                     "">=$20"","
"0","                       TRUE ~ NA_character_), "
"0","           usd_person_bin = fct_relevel(usd_person_bin, c(""<$2"", "">=$2_<$4"", "
"0","                                                          "">=$4_<$6"", "">=$6_<$8"", "
"0","                                                          "">=$8_<$10"","">=$10_<$12"","
"0","                                                          "">=$12_<$14"", "">=$14_<$16"", "
"0","                                                          "">=$16_<$18"", "">=$18_<$20"", "
"0","                                                          "">=20""))) %>% "
"0","    mutate(location_type = recode(location_type, ""village"" = ""Village"")) %>% "
"0","    rename(so = hrp_indicators) %>%  "
"0","    group_by(row_index) %>% "
"0","    slice(which.max(beneficiaries)) %>% "
"0","    ungroup() %>%"
"0","    rename(pwd_male = people_with_disability_male,"
"0","           pwd_female = people_with_disability_female,"
"0","           pwd_total = total_number_of_people_with_disability)"
"0","}"
"0","  "
"0",""
